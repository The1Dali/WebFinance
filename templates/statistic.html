<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Financial Tracker - Statistics</title>
        <link href="favicon.jpg" rel="icon">
        <link href="styles.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="profile.js"></script>
    </head>
    <body>
        <div id="profile-container">

        </div>

        <!-- Statistics Section -->
        <section class="mb-4 container">
            <div class="d-flex align-items-center mb-3 position-relative">
                <a class="btn btn-outline-warning" href="index.html">Back</a>
                <h3 class="mb-0 position-absolute start-50 translate-middle-x">Statistics</h3>
            </div>
            <!-- Histogram Chart -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
                        <h5 class="card-title mb-0">Income vs Expenses</h5>
                        <div class="d-flex gap-2 flex-wrap">
                            <select id="timeView" class="form-select form-select-sm timec">
                                <option value="daily">Daily View</option>
                                <option value="weekly" selected>Weekly View</option>
                                <option value="monthly">Monthly View</option>
                                <option value="annual">Annual View</option>
                            </select>
                            <select id="timePeriod" class="form-select form-select-sm timec">
                                <option value="current">Current Month</option>
                            </select>
                        </div>
                    </div>
                    <canvas id="histogramChart"></canvas>
                </div>
            </div>

            <!-- Pie Charts Section -->
            <div class="row g-3">
                <div class="col-md-6">
                    <h5 class="mb-3 text-center">Income by Category</h5>
                    <div class="canvasb">
                        <canvas id="incomePieChart"></canvas>
                    </div>
                </div>
                <div class="col-md-6">
                    <h5 class="mb-3 text-center">Expenses by Category</h5>
                    <div class="canvasb">
                        <canvas id="expensesPieChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Add Button -->
        <a href="addt.html" class="btn btn-warning position-fixed bottom-0 end-0 m-3 rounded-circle addb">
            <span style="font-size: 28px;" 28px;>+</span>
        </a>

        <script>
        // Load profile section
        fetch('profile.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('profile-container').innerHTML = data;
        });
        
        // Sample data for different time views
        const sampleData = {
            daily: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                income: [150, 200, 180, 220, 190, 250, 300],
                expenses: [120, 150, 140, 180, 160, 200, 180]
            },
            weekly: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                income: [1200, 1100, 1300, 1400],
                expenses: [950, 900, 1050, 1100]
            },
            monthly: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                income: [4200, 4100, 4500, 4300, 4400, 4600, 4700, 4500, 4400, 4800, 4600, 5000],
                expenses: [3400, 3200, 3600, 3500, 3700, 3800, 3900, 3700, 3600, 4000, 3800, 4100]
            },
            annual: {
                labels: ['2021', '2022', '2023', '2024'],
                income: [45000, 48000, 52000, 54000],
                expenses: [38000, 40000, 43000, 45000]
            }
        };

        // Histogram Chart
        const ctx = document.getElementById('histogramChart').getContext('2d');
        let histogramChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: sampleData.weekly.labels,
                datasets: [{
                    label: 'Income',
                    data: sampleData.weekly.income,
                    backgroundColor: '#28a745',
                    borderColor: '#1e7e34',
                    borderWidth: 1
                }, {
                    label: 'Expenses',
                    data: sampleData.weekly.expenses,
                    backgroundColor: '#dc3545',
                    borderColor: '#c82333',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toLocaleString();
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': $' + context.parsed.y.toLocaleString();
                            }
                        }
                    }
                }
            }
        });

        // Income Pie Chart with legend on the right
        const incomeCtx = document.getElementById('incomePieChart').getContext('2d');
        const incomePieChart = new Chart(incomeCtx, {
            type: 'pie',
            data: {
                labels: ['Salary', 'Freelance', 'Investment', 'Other'],
                datasets: [{
                    data: [60, 25, 10, 5],
                    backgroundColor: ['#28a745', '#20c997', '#17a2b8', '#6c757d'],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            padding: 15,
                            font: {
                                size: 12
                            }
                        }
                    }
                }
            }
        });

        // Expenses Pie Chart with legend on the right
        const expensesCtx = document.getElementById('expensesPieChart').getContext('2d');
        const expensesPieChart = new Chart(expensesCtx, {
            type: 'pie',
            data: {
                labels: ['Food', 'Bills', 'Transport', 'Entertainment', 'Other'],
                datasets: [{
                    data: [35, 25, 15, 15, 10],
                    backgroundColor: ['#dc3545', '#fd7e14', '#ffc107', '#e83e8c', '#6c757d'],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            padding: 15,
                            font: {
                                size: 12
                            }
                        }
                    }
                }
            }
        });

        // Update period options based on view
        function updatePeriodOptions(view) {
            const periodSelect = document.getElementById('timePeriod');
            periodSelect.innerHTML = '';
            
            switch(view) {
                case 'daily':
                    periodSelect.innerHTML = `
                        <option value="current">Current Week</option>
                        <option value="last">Last Week</option>
                        <option value="twoWeeks">2 Weeks Ago</option>
                    `;
                    break;
                case 'weekly':
                    periodSelect.innerHTML = `
                        <option value="current">Current Month</option>
                        <option value="last">Last Month</option>
                        <option value="twoMonths">2 Months Ago</option>
                    `;
                    break;
                case 'monthly':
                    periodSelect.innerHTML = `
                        <option value="current">Current Year</option>
                        <option value="last">Last Year</option>
                        <option value="twoYears">2 Years Ago</option>
                    `;
                    break;
                case 'annual':
                    periodSelect.innerHTML = `
                        <option value="all">All Years</option>
                        <option value="last5">Last 5 Years</option>
                        <option value="last10">Last 10 Years</option>
                    `;
                    break;
            }
        }

        // Update chart data
        function updateChart(view) {
            const data = sampleData[view];
            histogramChart.data.labels = data.labels;
            histogramChart.data.datasets[0].data = data.income;
            histogramChart.data.datasets[1].data = data.expenses;
            histogramChart.update();
        }

        // Event listeners for time view changes
        document.getElementById('timeView').addEventListener('change', function(e) {
            const view = e.target.value;
            updatePeriodOptions(view);
            updateChart(view);
        });

        document.getElementById('timePeriod').addEventListener('change', function(e) {
            console.log('Period changed to:', e.target.value);
        });

        // Initialize period options
        updatePeriodOptions('weekly');

        </script>
    </body>
</html>